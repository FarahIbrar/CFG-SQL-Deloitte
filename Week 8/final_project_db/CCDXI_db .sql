CREATE DATABASE CCXI;
-- CCXI stands for Code Cricket XI
USE CCXI;

-- Users table: Stores information about users who have accounts on CCXI (Code Cricket XI).
CREATE TABLE Users (
    user_id INT PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL,
    password VARCHAR(20) NOT NULL,
    join_date DATE NOT NULL,
    last_login DATETIME
);

-- Leagues table: Contains details about cricket leagues, including their names, start and end dates, and status.
CREATE TABLE Leagues (
    league_id INT PRIMARY KEY,
    league_name VARCHAR(70) NOT NULL,
    start_date DATE NOT NULL,
    end_date DATE,
    status VARCHAR(20) NOT NULL
);

-- Teams table: Represents cricket teams participating in leagues, with details like team name, home ground, and coaches.
CREATE TABLE Teams (
    team_id INT PRIMARY KEY,
    team_name VARCHAR(50) NOT NULL,
    league_id INT,
    home_ground VARCHAR(180),
    head_coach VARCHAR(50),
    batting_coach VARCHAR(50),
    bowling_coach VARCHAR(50),
    fielding_coach VARCHAR(50),
    FOREIGN KEY (league_id) REFERENCES Leagues(league_id)
);

-- Players table: Stores information about cricket players, including their playing position, batting and bowling styles, and nationality.
CREATE TABLE Players (
    player_id INT PRIMARY KEY,
    player_name VARCHAR(55) NOT NULL,
    team_id INT,
    position VARCHAR(50),
    batting_style VARCHAR(40),
    bowling_style VARCHAR(40),
    nationality VARCHAR(50),
	is_captain BOOLEAN DEFAULT false,  -- To indicate that a player is not a captain unless explicitly set to "true".
    FOREIGN KEY (team_id) REFERENCES Teams(team_id)
);

-- Matches table: Contains details about cricket matches, including the teams playing, venue, date, and match result.
CREATE TABLE Matches (
    match_id INT PRIMARY KEY,
    league_id INT,
    team1_id INT,
    team2_id INT,
    match_date DATE,
    venue VARCHAR(100),
    result VARCHAR(50),
    home_ground VARCHAR(180),
    league_name VARCHAR(100),
    FOREIGN KEY (league_id) REFERENCES Leagues(league_id),
    FOREIGN KEY (team1_id) REFERENCES Teams(team_id),
    FOREIGN KEY (team2_id) REFERENCES Teams(team_id)
);

-- BattingRecords table: Records detailed batting performance statistics for each player in the tournament.
CREATE TABLE BattingRecords (
    batting_record_id INT PRIMARY KEY AUTO_INCREMENT, -- to ensure each record has a unique identifier, which is automatically generated by the database. This makes it easier to manage and reference individual batting records, as they each have a distinct assigned primary key. 
    player_id INT,
    league_id INT,
    total_matches_played INT,
    total_innings_played INT,
    total_tournament_runs INT,
    highest_score VARCHAR(10),
    average DECIMAL(5,2),
    strike_rate DECIMAL(5,2),
    hundreds INT,
    fifties INT,
    ducks INT,
    fours INT,
    sixes INT,
    FOREIGN KEY (player_id) REFERENCES Players(player_id),
    FOREIGN KEY (league_id) REFERENCES Leagues(league_id)
);

-- BowlingRecords table: Records detailed bowling performance statistics for each player in the tournament.
CREATE TABLE BowlingRecords (
    bowling_record_id INT PRIMARY KEY AUTO_INCREMENT,
    player_id INT,
    league_id INT,
    total_matches_played INT,
    total_innings_played INT,
    overs DECIMAL(5,2),
    maidens INT,
    runs INT,
    wickets INT,
    average DECIMAL(5,2),
    economy DECIMAL(5,2),
    strike_rate DECIMAL(5,2),
    FOREIGN KEY (player_id) REFERENCES Players(player_id),
    FOREIGN KEY (league_id) REFERENCES Leagues(league_id)
);

-- User_Predictions table: Stores predictions made by users about match outcomes.
CREATE TABLE User_Predictions (
    prediction_id INT PRIMARY KEY,
    user_id INT,
    match_id INT,
    predicted_winner VARCHAR(100),
    prediction_date DATE,
    FOREIGN KEY (user_id) REFERENCES Users(user_id),
    FOREIGN KEY (match_id) REFERENCES Matches(match_id)
);

-- User_FavouriteTeams table: Stores information about which teams are marked as favorite by each user.
CREATE TABLE User_FavouriteTeams (
    favourite_id INT PRIMARY KEY,
    user_id INT,
    team_id INT,
    FOREIGN KEY (user_id) REFERENCES Users(user_id),
    FOREIGN KEY (team_id) REFERENCES Teams(team_id)
);

INSERT INTO Users (user_id, username, email, password, join_date, last_login) VALUES
(1, 'johndoe', 'johndoe@example.com', 'pass123', '2023-01-15', '2024-05-01 14:23:00'),
(2, 'janedoe', 'janedoe@example.com', 'word456', '2023-02-20', '2024-05-02 09:15:00'),
(3, 'bobsaget', 'bobsaget@example.com', '123word', '2023-03-05', '2024-05-01 18:45:00'),
(4, 'alicew', 'alicew@example.com', 'alice789', '2023-04-10', '2024-05-03 11:25:00'),
(5, 'charliek', 'charliek@example.com', 'charlie000', '2023-05-25', '2024-05-01 22:30:00'),
(6, 'dianad', 'dianad@example.com', 'diana!23', '2023-06-12', '2024-05-02 13:45:00'),
(7, 'edwardr', 'edwardr@example.com', 'edward$99', '2023-07-18', '2024-05-01 07:10:00'),
(8, 'frankm', 'frankm@example.com', 'frankM56', '2023-08-22', '2024-05-03 15:50:00'),
(9, 'ginag', 'ginag@example.com', 'gina456', '2023-09-30', '2024-05-02 12:20:00'),
(10, 'harryp', 'harryp@example.com', 'harry789', '2023-10-05', '2024-05-01 10:05:00');

INSERT INTO Leagues (league_id, league_name, start_date, end_date, status) VALUES
(1, 'Pakistan Super League', '2024-01-15', '2024-02-25', 'completed'),
(2, 'Indian Premier League', '2024-03-25', '2024-05-10', 'ongoing'),
(3, 'Big Bash League', '2024-11-01', '2024-12-20', 'upcoming');

INSERT INTO Teams (team_id, team_name, league_id, home_ground, head_coach, batting_coach, bowling_coach, fielding_coach) VALUES
-- PSL Teams
(1, 'Lahore Qalandars', 1, 'Gaddafi Stadium', 'Aqib Javed', 'Mansoor Rana', 'Waqas Ahmed', 'Shahzad Butt'),
(2, 'Karachi Kings', 1, 'National Stadium', 'Phil Simmons', 'Ravi Bopara', 'Steven Kirby', 'Mohammad Mansoor'),
(3, 'Islamabad United', 1, 'Rawalpindi Cricket Stadium', 'Mike Hesson', 'Ashley Wright', 'James Franklin', 'Simon Helmot'),
(4, 'Multan Sultans', 1, 'Multan Cricket Stadium', 'Abdul Rehman', 'Alex Hartley', 'Catherine Dalton', 'Drikus Saaiman'),
-- IPL Teams
(5, 'Royal Challengers Bengaluru', 2, 'M. Chinnaswamy Stadium', 'Andy Flower', 'Adam Griffith', 'Sridharan Sriram', 'Malolan Rangarajan'),
(6, 'Chennai Super Kings', 2, 'M. A. Chidambaram Stadium', 'Stephen Fleming', 'Michael Hussey', 'Dwayne Bravo', 'Rajiv Kumar'),
(7, 'Mumbai Indians', 2, 'Wankhede Stadium', 'Mark Boucher', 'Kieron Pollard', 'Shane Bond', 'James Pamment'),
(8, 'Lucknow Super Giants', 2, 'Bharat Ratna Shri Atal Bihari Vajpayee Ekana Cricket Stadium', 'Justin Langer', 'Warren Andrews', 'Pravin Tambe', 'Jonty Rhodes'),
-- BBL Teams
(9, 'Perth Scorchers', 3, 'Optus Stadium', 'Adam Voges', 'Adam Voges', 'Tim Macdonald', 'Beau Casson'),
(10, 'Brisbane Heat', 3, 'The Gabba', 'Johan Botha', 'Darren Lehmann', 'Andy Bichel', 'Johan Botha'),
(11, 'Sydney Sixers', 3, 'Sydney Cricket Ground', 'Greg Shipperd', 'Greg Shipperd', 'Dan Christian', 'Dan Christian'),
(12, 'Adelaide Strikers', 3, 'Adelaide Oval', 'Jason Gillespie', 'Jason Gillespie', 'Tim Paine', 'Tim Paine');

INSERT INTO Players (player_id, player_name, team_id, position, batting_style, bowling_style, nationality, is_captain)
VALUES
-- Lahore Qalandars
(1, 'Abdullah Shafique', 1, 'Opening Batter', 'Right hand Bat', 'Right arm Offbreak', 'Pakistan', false),
(2, 'Fakhar Zaman', 1, 'Opening Batter', 'Left hand Bat', 'Slow Left arm Orthodox', 'Pakistan', false),
(3, 'Shai Hope', 1, 'Wicketkeeper Batter', 'Right hand Bat', NULL, 'West Indies', false),
(4, 'Rassie van der Dussen', 1, 'Top order Batter', 'Right hand Bat', 'Legbreak', 'South Africa', false),
(5, 'George Linde', 1, 'Allrounder', 'Left hand Bat', 'Slow Left arm Orthodox', 'South Africa', false),
(6, 'Rashid Khan', 1, 'Bowling Allrounder', 'Right hand Bat', 'Legbreak Googly', 'Afghanistan', false),
(7, 'Sikandar Raza', 1, 'Batting Allrounder', 'Right hand Bat', 'Right arm Offbreak, Legbreak', 'Zimbabwe', false),
(8, 'David Wiese', 1, 'Allrounder', 'Right hand Bat', 'Right arm Medium fast', 'Namibia', false),
(9, 'Haris Rauf', 1, 'Bowler', 'Right hand Bat', 'Right arm Fast', 'Pakistan', false),
(10, 'Shaheen Shah Afridi', 1, 'Bowler', 'Left hand Bat', 'Left arm Fast', 'Pakistan', true),
(11, 'Zaman Khan', 1, 'Bowler', 'Right hand Bat', 'Right arm Fast', 'Pakistan', false),
-- Karachi Kings: 2
(12, 'Irfan Khan', 2, 'Middle order Batter', 'Right hand Bat', 'Right arm Medium fast', 'Pakistan', false),
(13, 'Tim Seifert', 2, 'Wicketkeeper Batter', 'Right hand Bat', NULL, 'New Zealand', false),
(14, 'Shan Masood', 2, 'Opening Batter', 'Left hand Bat', 'Right arm Medium fast', 'Pakistan', true),
(15, 'James Vince', 2, 'Batter', 'Right hand Bat', 'Right arm Medium', 'England', false),
(16, 'Mohammad Nawaz', 2, 'Allrounder', 'Left hand Bat', 'Slow Left arm Orthodox', 'Pakistan', false),
(17, 'Kieron Pollard', 2, 'Batting Allrounder', 'Right hand Bat', 'Right arm Medium', 'West Indies', false),
(18, 'Daniel Sams', 2, 'Allrounder', 'Right hand Bat', 'Left arm Fast medium', 'Australia', false),
(19, 'Shoaib Malik', 2, 'Allrounder', 'Right hand Bat', 'Right arm Offbreak', 'Pakistan', false),
(20, 'Anwar Ali', 2, 'Bowler', 'Right hand Bat', 'Right arm Medium fast', 'Pakistan', false),
(21, 'Hasan Ali', 2, 'Bowler', 'Right hand Bat', 'Right arm Medium fast', 'Pakistan', false),
(22, 'Tabraiz Shamsi', 2, 'Bowler', 'Right hand Bat', 'Left arm Wrist spin', 'South Africa', false),
-- Islamabad United: 3
(23, 'Azam Khan', 3, 'Wicketkeeper Batter', 'Right hand Bat', NULL, 'Pakistan', false),
(24, 'Alex Hales', 3, 'Opening Batter', 'Right hand Bat', 'Right arm Medium', 'England', false),
(25, 'Colin Munro', 3, 'Opening Batter', 'Left hand Bat', 'Right arm Medium fast', 'New Zealand', false),
(26, 'Agha Salman', 3, 'Allrounder', 'Right hand Bat', 'Right arm Offbreak', 'Pakistan', false),
(27, 'Tom Curran', 3, 'Allrounder', 'Right hand Bat', 'Right arm Fast medium', 'England', false),
(28, 'Faheem Ashraf', 3, 'Bowling Allrounder', 'Left hand Bat', 'Right arm Medium', 'Pakistan', false),
(29, 'Imad Wasim', 3, 'Allrounder', 'Left hand Bat', 'Slow Left arm Orthodox', 'Pakistan', false),
(30, 'Shadab Khan', 3, 'Allrounder', 'Right hand Bat', 'Legbreak', 'Pakistan', true),
(31, 'Hunain Shah', 3, 'Bowler', 'Right hand Bat', 'Right arm Medium', 'Pakistan', false),
(32, 'Tymal Mills', 3, 'Bowler', 'Right hand Bat', 'Left arm Fast', 'England', false),
(33, 'Naseem Shah', 3, 'Bowler', 'Right hand Bat', 'Right arm Fast', 'Pakistan', false),
-- Multan Sultans: 4
(34, 'Johnson Charles', 4, 'Wicketkeeper Batter', 'Right hand Bat', NULL, 'West Indies', false),
(35, 'Iftikhar Ahmed', 4, 'Middle order Batter', 'Right hand Bat', 'Right arm Offbreak', 'Pakistan', false),
(36, 'Khushdil Shah', 4, 'Middle order Batter', 'Left hand Bat', 'Slow Left arm Orthodox', 'Pakistan', false),
(37, 'Dawid Malan', 4, 'Top order Batter', 'Left hand Bat', 'Legbreak', 'England', false),
(38, 'Mohammad Rizwan', 4, 'Wicketkeeper Batter', 'Right hand Bat', 'Right arm Medium', 'Pakistan', true),
(39, 'David Willey', 4, 'Bowling Allrounder', 'Left hand Bat', 'Left arm Fast medium', 'England', false),
(40, 'Abbas Afridi', 4, 'Bowler', 'Right hand Bat', 'Right arm Medium fast', 'Pakistan', false),
(41, 'Chris Jordan', 4, 'Bowler', 'Right hand Bat', 'Right arm Fast medium', 'England', false),
(42, 'Shahnawaz Dahani', 4, 'Bowler', 'Right hand Bat', 'Right arm Fast medium', 'Pakistan', false),
(43, 'Reece Topley', 4, 'Bowler', 'Right hand Bat', 'Left arm Fast medium', 'England', false),
(44, 'Usama Mir', 4, 'Bowler', 'Right hand Bat', 'Legbreak', 'Pakistan', false),
-- Chennai Super Kings: 5, Royal Challengers Bangalore: 6, Mumbai Indians: 7, Lucknow Super Giants: 8
-- Chennai Super Kings: 5
(45, 'Ruturaj Gaikwad', 5, 'Batter', 'Right hand Bat', 'Right arm Offbreak', 'India', true),
(46, 'MS Dhoni', 5, 'Wicketkeeper Batter', 'Right hand Bat', 'Right arm Medium', 'India', false),
(47, 'Ajinkya Rahane', 5, 'Top order Batter', 'Right hand Bat', 'Right arm Medium', 'India', false),
(48, 'Moeen Ali', 5, 'Batting Allrounder', 'Left hand Bat', 'Right arm Offbreak', 'England', false),
(49, 'Ravindra Jadeja', 5, 'Allrounder', 'Left hand Bat', 'Slow Left arm Orthodox', 'India', false),
(50, 'Daryl Mitchell', 5, 'Batting Allrounder', 'Right hand Bat', 'Right arm Medium', 'New Zealand', false),
(51, 'Mitchell Santner', 5, 'Bowling Allrounder', 'Left hand Bat', 'Slow Left arm Orthodox', 'New Zealand', false),
(52, 'Deepak Chahar', 5, 'Bowler', 'Right hand Bat', 'Right arm Medium', 'India', false),
(53, 'Richard Gleeson', 5, 'Bowler', 'Right hand Bat', 'Right arm Fast medium', 'England', false),
(54, 'Simarjeet Singh', 5, 'Bowler', 'Right hand Bat', 'Right arm Medium fast', 'India', false),
(55, 'Maheesh Theekshana', 5, 'Bowler', 'Right hand Bat', 'Right arm Offbreak', 'India', false),
-- Royal Challengers Bangalore: 6
(56, 'Faf du Plessis', 6, 'Middle order Batter', 'Right hand Bat', 'Legbreak', 'South Africa', true),
(57, 'Saurav Chauhan', 6, 'Top order Batter', 'Left hand Bat', 'Right arm Offbreak', 'India', false),
(58, 'Virat Kohli', 6, 'Top order Batter', 'Right hand Bat', 'Right arm Medium', 'India', false),
(59, 'Tom Curran', 6, 'Allrounder', 'Right hand Bat', 'Right arm Fast medium', 'England', false),
(60, 'Cameron Green', 6, 'Batting Allrounder', 'Right hand Bat', 'Right arm Fast medium', 'Australia', false),
(61, 'Will Jacks', 6, 'Batting Allrounder', 'Right hand Bat', 'Right arm Offbreak', 'England', false),
(62, 'Glenn Maxwell', 6, 'Batting Allrounder', 'Right hand Bat', 'Right arm Offbreak', 'Australia', false),
(63, 'Lockie Ferguson', 6, 'Bowler', 'Right hand Bat', 'Right arm Fast', 'New Zealand', false),
(64, 'Alzarri Joseph', 6, 'Bowler', 'Right hand Bat', 'Right arm Fast', 'West Indies', false),
(65, 'Reece Topley', 6, 'Bowler', 'Right hand Bat', 'Left arm Fast medium', 'England', false),
(66, 'Vijaykumar Vyshak', 6, 'Bowler', 'Right hand Bat', 'Right arm Medium', 'India', false),
-- Mumbai Indians: 7
(67, 'Tim David', 7, 'Middle order Batter', 'Right hand Bat', 'Right arm Offbreak', 'Australia', false),
(68, 'Ishan Kishan', 7, 'Wicketkeeper Batter', 'Left hand Bat', NULL, 'India', false),
(69, 'Rohit Sharma', 7, 'Top order Batter', 'Right hand Bat', 'Right arm Offbreak', 'India', false),
(70, 'Suryakumar Yadav', 7, 'Batter', 'Right hand Bat', 'Right arm Medium, Right arm Offbreak', 'India', false),
(71, 'Hardik Pandya', 7, 'Allrounder', 'Right hand Bat', 'Right arm Medium fast', 'India', true),
(72, 'Dewald Brevis', 7, 'Batting Allrounder', 'Right hand Bat', 'Legbreak', 'South Africa', false),
(73, 'Shreyas Gopal', 7, 'Allrounder', 'Right hand Bat', 'Legbreak', 'India', false),
(74, 'Mohammad Nabi', 7, 'Allrounder', 'Right hand Bat', 'Right arm Offbreak', 'Afghanistan', false),
(75, 'Romario Shepherd', 7, 'Bowling Allrounder', 'Right hand Bat', 'Right arm Fast medium', 'West Indies', false),
(76, 'Jasprit Bumrah', 7, 'Bowler', 'Right hand Bat', 'Right arm Fast', 'India', false),
(77, 'Gerald Coetzee', 7, 'Bowler', 'Right hand Bat', 'Right arm Fast', 'South Africa', false),
-- Lucknow Super Giants: 8
(78, 'KL Rahul', 8, 'Wicketkeeper Batter', 'Right hand Bat', NULL, 'India', true),
(79, 'Quinton de Kock', 8, 'Wicketkeeper Batter', 'Left hand Bat', NULL, 'South Africa', false),
(80, 'Nicholas Pooran', 8, 'Wicketkeeper Batter', 'Left hand Bat', 'Right arm Offbreak', 'West Indies', false),
(81, 'Ashton Turner', 8, 'Middle order Batter', 'Right hand Bat', 'Right arm Offbreak', 'Australia', false),
(82, 'Kyle Mayers', 8, 'Batting Allrounder', 'Left hand Bat', 'Right arm Medium', 'West Indies', false),
(83, 'Marcus Stoinis', 8, 'Batting Allrounder', 'Right hand Bat', 'Right arm Medium', 'Australia', false),
(84, 'David Willey', 8, 'Bowling Allrounder', 'Left hand Bat', 'Left arm Fast medium', 'England', false),
(85, 'Matt Henry', 8, 'Bowler', 'Right hand Bat', 'Right arm Fast medium', 'New Zealand', false),
(86, 'Shamar Joseph', 8, 'Bowler', 'Left hand Bat', 'Right arm Fast', 'West Indies', false),
(87, 'Mayank Yadav', 8, 'Bowler', 'Right hand Bat', 'Right arm Fast', 'India', false),
(88, 'Yash Thakur', 8, 'Bowler', 'Right hand Bat', 'Right arm Fast medium', 'India', false), 
-- Perth Scorchers: 9, Brisbane Heat: 10, Sydney Sixers: 11, Adelaide Strikers: 12
-- Perth Scorchers: 9
(89, 'Cooper Connolly', 9, 'Top order Batter', 'Left hand Bat', 'Slow Left arm Orthodox', 'Australia', false),
(90, 'Zak Crawley', 9, 'Top order Batter', 'Right hand Bat', 'Right arm Offbreak', 'England', false),
(91, 'Stephen Eskinazi', 9, 'Middle order Batter', 'Right hand Bat', NULL, 'Australia', false),
(92, 'Laurie Evans', 9, 'Batter', 'Right hand Bat', 'Right arm Offbreak', 'England', false),
(93, 'Aaron Hardie', 9, 'Allrounder', 'Right hand Bat', 'Right arm Medium fast', 'Australia', true),
(94, 'Mitchell Marsh', 9, 'Allrounder', 'Right hand Bat', 'Right arm Medium', 'Australia', false),
(95, 'Ashton Agar', 9, 'Bowler', 'Left hand Bat', 'Slow Left arm Orthodox', 'Australia', false),
(96, 'Jason Behrendorff', 9, 'Bowler', 'Right hand Bat', 'Left arm Fast medium', 'Australia', false),
(97, 'Matthew Kelly', 9, 'Bowler', 'Right hand Bat', 'Right arm Fast medium', 'Australia', false),
(98, 'Lance Morris', 9, 'Bowler', 'Right hand Bat', 'Right arm Fast', 'Australia', false),
(99, 'Andrew Tye', 9, 'Bowler', 'Right hand Bat', 'Right arm Medium fast', 'Australia', false),
-- Brisbane Heat: 10
(100, 'Sam Billings', 10, 'Wicketkeeper Batter', 'Right hand Bat', NULL, 'England', false),
(101, 'Usman Khawaja', 10, 'Top order Batter', 'Left hand Bat', 'Right arm Medium', 'Australia', false),
(102, 'Marnus Labuschagne', 10, 'Batter', 'Right hand Bat', 'Legbreak', 'Australia', false),
(103, 'Colin Munro', 10, 'Opening Batter', 'Left hand Bat', 'Right arm Medium fast', 'New Zealand', false),
(104, 'Jimmy Peirson', 10, 'Wicketkeeper', 'Right hand Bat', NULL, 'Australia', false),
(105, 'Charlie Wakim', 10, 'Top order Batter', 'Right hand Bat', NULL, 'Australia', false),
(106, 'Nathan McSweeney', 10, 'Allrounder', 'Right hand Bat', 'Right arm Offbreak', 'Australia', true),
(107, 'Michael Neser', 10, 'Bowling Allrounder', 'Right hand Bat', 'Right arm Medium fast', 'Australia', false),
(108, 'Paul Walter', 10, 'Allrounder', 'Left hand Bat', 'Left arm Medium', 'England', false),
(109, 'Xavier Bartlett', 10, 'Bowler', 'Right hand Bat', 'Right arm Fast medium', 'Australia', false),
(110, 'Spencer Johnson', 10, 'Bowler', 'Left hand Bat', 'Left arm Fast', 'Australia', false),
-- Sydney Sixers: 11
(111, 'Jack Edwards', 11, 'Batter', 'Right hand Bat', 'Right arm Medium', 'Australia', false),
(112, 'Kurtis Patterson', 11, 'Middle order Batter', 'Left hand Bat', 'Right arm Offbreak', 'Australia', false),
(113, 'Josh Philippe', 11, 'Wicketkeeper Batter', 'Right hand Bat', NULL, 'Australia', false),
(114, 'Steven Smith', 11, 'Top order Batter', 'Right hand Bat', 'Legbreak Googly', 'Australia', false),
(115, 'James Vince', 11, 'Batter', 'Right hand Bat', 'Right arm Medium', 'England', false),
(116, 'Sean Abbott', 11, 'Bowling Allrounder', 'Right hand Bat', 'Right arm Fast medium', 'Australia', false),
(117, 'Tom Curran', 11, 'Allrounder', 'Right hand Bat', 'Right arm Fast medium', 'England', false),
(118, 'Moises Henriques', 11, 'Allrounder', 'Right hand Bat', 'Right arm Fast medium', 'Australia', true),
(119, 'Ben Dwarshuis', 11, 'Bowler', 'Left hand Bat', 'Left arm Fast medium', 'Australia', false),
(120, 'Izharulhaq Naveed', 11, 'Bowler', 'Right hand Bat', 'Legbreak', 'Afghanistan', false),
(121, 'Jackson Bird', 11, 'Bowler', 'Right hand Bat', 'Right arm Fast medium', 'Australia', false),
-- Adelaide Strikers: 12
(122, 'Alex Carey', 12, 'Wicketkeeper Batter', 'Left hand Bat', NULL, 'Australia', false),
(123, 'Travis Head', 12, 'Top order Batter', 'Left hand Bat', 'Right arm Offbreak', 'Australia', false),
(124, 'Adam Hose', 12, 'Middle order Batter', 'Right hand Bat', 'Right arm Medium fast', 'England', false),
(125, 'Chris Lynn', 12, 'Batter', 'Right hand Bat', 'Slow Left arm Orthodox', 'Australia', false),
(126, 'Matthew Short', 12, 'Top order Batter', 'Right hand Bat', 'Right arm Offbreak', 'Australia', true),
(127, 'D Arcy Short', 12, 'Opening Batter', 'Left hand Bat', 'Left arm Wrist spin', 'Australia', false),
(128, 'Jamie Overton', 12, 'Bowling Allrounder', 'Right hand Bat', 'Right arm Fast', 'England', false),
(129, 'Cameron Boyce', 12, 'Bowler', 'Right hand Bat', 'Legbreak', 'Australia', false),
(130, 'Brendan Doggett', 12, 'Bowler', 'Right hand Bat', 'Right arm Fast medium', 'Australia', false),
(131, 'Ben Manenti', 12, 'Bowler', 'Right hand Bat', 'Right arm Offbreak', 'Australia', false),
(132, 'David Payne', 12, 'Bowler', 'Right hand Bat', 'Left arm Fast medium', 'England', false);

-- To find out all teams have exactly "11" players.
SELECT t.team_name, COUNT(p.player_id) AS num_players
FROM Teams t
LEFT JOIN Players p ON t.team_id = p.team_id
GROUP BY t.team_name
HAVING COUNT(p.player_id) <> 11;
-- This query gives a list of teams that do not have exactly 11 players. 
-- If a team is missing players or has more than 11 players, it will be shown in the result. 
-- If a team has exactly 11 players, it will not be included in the result.

-- To find out the playing XI for any team. "Change t.team_name" to the team you want.
SELECT p.player_name
FROM Players p
JOIN Teams t ON p.team_id = t.team_id
WHERE t.team_name = 'Brisbane Heat';

-- To find out the captain only.
SELECT player_name
FROM Players
WHERE is_captain = true;
-- The query 'WHERE is_captain = true;' filters the 'Players' table 
-- to retrieve players whose 'is_captain column' is set to true (1), indicating they are captains.

-- To find out the captain, their nationality, home ground and the team they bleong to. 
SELECT 
p.player_name AS captain_name,
p.nationality,
t.team_name,
t. home_ground,
l.league_name
FROM Players p
JOIN Teams t ON p.team_id = t.team_id
JOIN Leagues l ON t.league_id = l.league_id
WHERE p.is_captain = true;

INSERT INTO Matches (match_id, league_id, team1_id, team2_id, match_date, venue, result, home_ground, league_name)
VALUES
(1, 1, 1, 2, '2024-03-18', 'National Stadium', 'Islamabad United won by 2 wickets', 'National Stadium', 'Pakistan Super League'),
(2, 1, 1, 2, '2024-03-10', 'Rawalpindi Cricket Stadium', 'Islamabad United won by 3 wickets', 'Rawalpindi Cricket Stadium', 'Pakistan Super League'),
(3, 1, 3, 4, '2024-03-09', 'National Stadium', 'Karachi Kings won by 3 wickets', 'National Stadium', 'Pakistan Super League'),
(4, 1, 1, 3, '2024-03-07', 'Rawalpindi Cricket Stadium', 'Islamabad United won by 5 wickets', 'Rawalpindi Cricket Stadium', 'Pakistan Super League'),
(5, 1, 1, 4, '2024-03-06', 'Rawalpindi Cricket Stadium', 'Lahore Qalandars won by 17 runs', 'Rawalpindi Cricket Stadium', 'Pakistan Super League'),
(6, 1, 3, 2, '2024-03-03', 'National Stadium', 'Multan Sultans won by 20 runs', 'National Stadium', 'Pakistan Super League'),
(7, 1, 3, 1, '2024-02-28', 'National Stadium', 'Islamabad United won by 7 wickets', 'National Stadium', 'Pakistan Super League'),
(8, 1, 4, 2, '2024-02-27', 'Gaddafi Stadium', 'Multan Sultans won by 60 runs', 'Gaddafi Stadium', 'Pakistan Super League'),
(9, 1, 4, 3, '2024-02-24', 'Gaddafi Stadium', 'Karachi Kings won by 2 wickets', 'Gaddafi Stadium', 'Pakistan Super League'),
(10, 1, 2, 4, '2024-02-21', 'Multan Cricket Stadium', 'Multan Sultans won by 5 wickets', 'Multan Cricket Stadium', 'Pakistan Super League'),
(11, 1, 2, 1, '2024-02-20', 'Multan Cricket Stadium', 'Multan Sultans won by 5 wickets', 'Multan Cricket Stadium', 'Pakistan Super League'),
(12, 1, 2, 3, '2024-02-18', 'Multan Cricket Stadium', 'Multan Sultans won by 55 runs', 'Multan Cricket Stadium', 'Pakistan Super League'),
(13, 1, 4, 1, '2024-02-17', 'Gaddafi Stadium', 'Islamabad United won by 8 wickets', 'Gaddafi Stadium', 'Pakistan Super League'),
(14, 2, 5, 6, '2023-05-24', 'M. A. Chidambaram Stadium', 'Mumbai Indians won by 81 runs', 'M. A. Chidambaram Stadium', 'Indian Premier League'),
(15, 2, 5, 6, '2023-05-16', 'BRSAB Vajpayee Ekana Stadium', 'Lucknow Super Giants won by 5 runs', 'BRSAB Vajpayee Ekana Stadium', 'Indian Premier League'),
(16, 2, 6, 7, '2023-05-09', 'Wankhede Stadium', 'Mumbai Indians won by 6 wickets', 'Wankhede Stadium', 'Indian Premier League'),
(17, 2, 8, 6, '2023-05-06', 'M. A. Chidambaram Stadium', 'Chennai Super Kings won by 6 wickets', 'M. A. Chidambaram Stadium', 'Indian Premier League'),
(18, 2, 5, 8, '2023-05-03', 'BRSAB Vajpayee Ekana Stadium', 'Match ended in no result', 'BRSAB Vajpayee Ekana Stadium', 'Indian Premier League'),
(19, 2, 5, 7, '2023-05-01', 'BRSAB Vajpayee Ekana Stadium', 'Royal Challengers Bangalore won by 18 runs', 'BRSAB Vajpayee Ekana Stadium', 'Indian Premier League'),
(20, 2, 7, 8, '2023-04-17', 'M. Chinnaswamy Stadium', 'Chennai Super Kings won by 8 runs', 'M. Chinnaswamy Stadium', 'Indian Premier League'),
(21, 2, 7, 5, '2023-04-10', 'M. Chinnaswamy Stadium', 'Lucknow Super Giants won by 1 wicket', 'M. Chinnaswamy Stadium', 'Indian Premier League'),
(22, 2, 6, 8, '2023-04-08', 'Wankhede Stadium', 'Chennai Super Kings won by 7 wickets', 'Wankhede Stadium', 'Indian Premier League'),
(23, 2, 7, 5, '2023-04-03', 'M. A. Chidambaram Stadium', 'Chennai Super Kings won by 12 runs', 'M. A. Chidambaram Stadium', 'Indian Premier League'),
(24, 2, 7, 6, '2023-04-02', 'M. Chinnaswamy Stadium', 'Royal Challengers Bangalore won by 8 wickets', 'M. Chinnaswamy Stadium', 'Indian Premier League'),
(25, 3, 9, 10, '2023-02-04', 'Perth Stadium', 'Perth Scorchers won by 5 wickets', 'Perth Stadium', 'Big Bash League'),
(26, 3, 11, 10, '2023-02-02', 'Sydney Cricket Ground', 'Brisbane Heat won by 4 wickets', 'Sydney Cricket Ground', 'Big Bash League'),
(27, 3, 9, 11, '2023-01-28', 'Perth Stadium', 'Perth Scorchers won by 7 wickets', 'Perth Stadium', 'Big Bash League'),
(28, 3, 12, 9, '2023-01-20', 'Adelaide Oval', 'Perth Scorchers won by 7 wickets', 'Adelaide Oval', 'Big Bash League'),
(29, 3, 11, 12, '2023-01-17', 'Coffs Harbour International Stadium', 'Sydney Sixers won by 59 runs', 'Coffs Harbour International Stadium', 'Big Bash League'),
(30, 3, 11, 9, '2023-01-15', 'Sydney Cricket Ground', 'Sydney Sixers won by 6 runs', 'Sydney Cricket Ground', 'Big Bash League'),
(31, 3, 12, 11, '2023-01-14', 'Adelaide Oval', 'Brisbane Heat won by 17 runs', 'Adelaide Oval', 'Big Bash League'),
(32, 3, 10, 12, '2023-01-11', 'The Gabba', 'Perth Scorchers won by 8 wickets', 'The Gabba', 'Big Bash League'),
(33, 3, 9, 10, '2023-01-07', 'Perth Stadium', 'Perth Scorchers won by 7 wickets', 'Perth Stadium', 'Big Bash League'),
(34, 3, 11, 10, '2023-01-04', 'North Sydney Oval', 'Match ended in no result', 'North Sydney Oval', 'Big Bash League'),
(35, 3, 10, 11, '2023-01-01', 'The Gabba', 'Brisbane Heat won by 15 runs', 'The Gabba', 'Big Bash League'),
(36, 3, 9, 12, '2022-12-26', 'Perth Stadium', 'Perth Scorchers won by 3 wickets', 'Perth Stadium', 'Big Bash League'),
(37, 3, 10, 12, '2022-12-23', 'The Gabba', 'Brisbane Heat won by 6 runs', 'The Gabba', 'Big Bash League'),
(38, 3, 9, 11, '2022-12-17', 'Perth Stadium', 'Perth Scorchers won by 38 runs', 'Perth Stadium', 'Big Bash League'),
(39, 3, 12, 11, '2022-12-14', 'Adelaide Oval', 'Adelaide Strikers won by 51 runs', 'Adelaide Oval', 'Big Bash League');

INSERT INTO User_Predictions (prediction_id, user_id, match_id, predicted_winner, prediction_date)
VALUES
-- Pakistan Super League predictions
(1, 1, 1, 'Islamabad United', '2024-03-18'),
(2, 1, 2, 'Islamabad United', '2024-03-10'),
(3, 2, 1, 'Islamabad United', '2024-03-18'),
(4, 2, 2, 'Islamabad United', '2024-03-10'),
(5, 3, 3, 'Karachi Kings', '2024-03-09'),
(6, 3, 4, 'Islamabad United', '2024-03-07'),
(7, 4, 3, 'Karachi Kings', '2024-03-09'),
(8, 4, 4, 'Islamabad United', '2024-03-07'),
(9, 5, 5, 'Lahore Qalandars', '2024-03-06'),
(10, 5, 6, 'Multan Sultans', '2024-03-03'),
(11, 6, 5, 'Lahore Qalandars', '2024-03-06'),
(12, 6, 6, 'Multan Sultans', '2024-03-03'),
(13, 7, 7, 'Multan Sultans', '2024-02-27'),
(14, 7, 8, 'Lahore Qalandars', '2024-02-24'),
(15, 8, 7, 'Multan Sultans', '2024-02-27'),
(16, 8, 8, 'Lahore Qalandars', '2024-02-24'),
(17, 9, 9, 'Multan Sultans', '2024-02-21'),
(18, 9, 10, 'Islamabad United', '2024-02-20'),
(19, 10, 9, 'Multan Sultans', '2024-02-21'),
(20, 10, 10, 'Islamabad United', '2024-02-20'),
-- Indian Premier League predictions
(21, 1, 14, 'Mumbai Indians', '2023-05-24'),
(22, 1, 15, 'Lucknow Super Giants', '2023-05-16'),
(23, 2, 16, 'Mumbai Indians', '2023-05-09'),
(24, 2, 17, 'Chennai Super Kings', '2023-05-06'),
(25, 3, 18, 'Mumbai Indians', '2023-05-03'),
(26, 3, 19, 'Royal Challengers Bangalore', '2023-05-01'),
(27, 4, 20, 'Chennai Super Kings', '2023-04-17'),
(28, 4, 21, 'Lucknow Super Giants', '2023-04-10'),
(29, 5, 22, 'Chennai Super Kings', '2023-04-08'),
(30, 5, 23, 'Chennai Super Kings', '2023-04-03'),
(31, 6, 24, 'Royal Challengers Bangalore', '2023-04-02'),
-- Big Bash League predictions
(32, 7, 25, 'Perth Scorchers', '2023-02-04'),
(33, 7, 26, 'Brisbane Heat', '2023-02-02'),
(34, 8, 27, 'Perth Scorchers', '2023-01-28'),
(35, 8, 28, 'Perth Scorchers', '2023-01-20'),
(36, 9, 29, 'Sydney Sixers', '2023-01-17'),
(37, 9, 30, 'Sydney Sixers', '2023-01-15'),
(38, 10, 31, 'Brisbane Heat', '2023-01-14'),
(39, 10, 32, 'Perth Scorchers', '2023-01-11'),
(40, 1, 33, 'Perth Scorchers', '2023-01-07'),
(41, 1, 34, 'Brisbane Heat', '2023-01-04'),
(42, 2, 35, 'Brisbane Heat', '2023-01-01'),
(43, 2, 36, 'Perth Scorchers', '2022-12-26'),
(44, 3, 37, 'Brisbane Heat', '2022-12-23'),
(45, 3, 38, 'Perth Scorchers', '2022-12-17'),
(46, 4, 39, 'Adelaide Strikers', '2022-12-14');

-- User_FavouriteTeams with predefined favorites for users
INSERT INTO User_FavouriteTeams (favourite_id, user_id, team_id)
VALUES
(1, 1, 1),     -- John Doe: Lahore Qalandars
(2, 2, 1),     -- Jane Doe: Lahore Qalandars
(3, 3, 9),     -- Bob Saget: Perth Scorchers
(4, 4, 1),     -- Alice W: Lahore Qalandars
(5, 5, 9),     -- Charlie K: Perth Scorchers
(6, 6, 6),     -- Diana D: Chennai Super Kings
(7, 7, 1),     -- Edward R: Lahore Qalandars
(8, 8, 6),     -- Frank M: Chennai Super Kings
(9, 9, 9),     -- Gina G: Perth Scorchers
(10, 10, 6);   -- Harry P: Chennai Super Kings


-- Most popular team based on the user's favourites.
SELECT t.team_id, t.team_name, COUNT(ft.user_id) AS num_users
FROM Teams t
JOIN User_FavouriteTeams ft ON t.team_id = ft.team_id
GROUP BY t.team_id, t.team_name
ORDER BY num_users DESC;

-- Most Popular league based on the user's favourites. 
SELECT l.league_id, l.league_name, COUNT(ft.user_id) AS num_users
FROM Leagues l
JOIN Teams t ON l.league_id = t.league_id
JOIN User_FavouriteTeams ft ON t.team_id = ft.team_id
GROUP BY l.league_id, l.league_name
ORDER BY num_users DESC;

-- Most engaged users by analyzing their activity data such as the number of predictions they made or the number of logins.
SELECT U.username, COUNT(P.prediction_id) AS prediction_count
FROM Users U
JOIN User_Predictions P ON U.user_id = P.user_id
GROUP BY U.user_id, U.username
ORDER BY prediction_count DESC
LIMIT 1;

INSERT INTO BattingRecords (player_id, league_id, total_matches_played, total_innings_played, total_tournament_runs, highest_score, average, strike_rate, hundreds, fifties, ducks, fours, sixes)
VALUES
(17, 1, 9, 8, 239, '58', 47.80, 151.26, 0, 1, 0, 14, 15), -- Kieron Pollard
(12, 1, 9, 8, 171, '39*', 42.75, 140.16, 0, 0, 0, 22, 3), -- Irfan Khan
(20, 1, 3, 3, 40, '25*', 40.00, 173.91, 0, 0, 0, 3, 2), -- Anwar Ali
(19, 1, 10, 10, 254, '53', 31.75, 115.98, 0, 1, 0, 19, 5), -- Shoaib Malik
(15, 1, 9, 9, 214, '42', 26.75, 121.59, 0, 0, 0, 34, 2), -- James Vince
(13, 1, 7, 7, 182, '49', 26.00, 132.84, 0, 0, 0, 23, 4), -- Tim Seifert
(16, 1, 8, 6, 88, '28', 17.60, 125.71, 0, 0, 0, 11, 1), -- Mohammad Nawaz
(14, 1, 10, 10, 158, '36', 15.80, 105.33, 0, 0, 1, 21, 1), -- Shan Masood
(21, 1, 10, 6, 37, '17', 9.25, 137.03, 0, 0, 1, 1, 2), -- Hasan Ali
(18, 1, 4, 2, 7, '7', 3.50, 70.00, 0, 0, 1, 1, 0), -- Daniel Sams
(22, 1, 4, 1, 0, '0*', 0.00, 0.00, 0, 0, 0, 0, 0), -- Tabraiz Shamsi
(4, 1, 7, 7, 364, '104*', 72.80, 154.89, 1, 3, 0, 25, 16), -- Rassie van der Dussen
(8, 1, 4, 3, 62, '24*', 62.00, 221.42, 0, 0, 0, 4, 4), -- David Wiese
(1, 1, 5, 5, 159, '59*', 53.00, 135.89, 0, 2, 0, 8, 7), -- Abdullah Shafique
(5, 1, 4, 2, 31, '26*', 31.00, 155.00, 0, 0, 0, 3, 1), -- George Linde
(2, 1, 8, 8, 157, '54', 19.62, 115.44, 0, 1, 0, 13, 4), -- Fakhar Zaman
(10, 1, 9, 6, 107, '55', 17.83, 164.61, 0, 1, 1, 3, 10), -- Shaheen Shah Afridi
(7, 1, 8, 8, 91, '23', 15.16, 133.82, 0, 0, 1, 8, 4), -- Sikandar Raza
(3, 1, 5, 5, 70, '29', 14.00, 111.11, 0, 0, 0, 4, 2), -- Shai Hope
(11, 1, 9, 1, 1, '1', 1.00, 33.33, 0, 0, 0, 0, 0), -- Zaman Khan
(9, 1, 4, 0, 0, NULL, 0.00, 0.00, 0, 0, 0, 0, 0); -- Haris Rauf

INSERT INTO BattingRecords (player_id, league_id, total_matches_played, total_innings_played, total_tournament_runs, highest_score, average, strike_rate, hundreds, fifties, ducks, fours, sixes)
VALUES
(25, 1, 10, 10, 326, '84', 32.60, 138.72, 0, 3, 0, 36, 12), -- Colin Munro
(26, 1, 12, 12, 310, '64*', 31.00, 140.27, 0, 2, 0, 27, 12), -- Agha Salman
(30, 1, 12, 12, 305, '80', 30.50, 142.52, 0, 3, 1, 23, 15), -- Shadab Khan
(23, 1, 12, 10, 226, '75', 25.11, 171.21, 0, 1, 1, 21, 14), -- Azam Khan
(29, 1, 12, 9, 126, '59*', 21.00, 128.57, 0, 1, 2, 16, 1), -- Imad Wasim
(33, 1, 11, 6, 62, '27', 20.66, 163.15, 0, 0, 0, 4, 5), -- Naseem Shah
(28, 1, 12, 8, 100, '41*', 16.66, 129.87, 0, 0, 0, 7, 4), -- Faheem Ashraf
(24, 1, 10, 10, 148, '47', 14.80, 124.36, 0, 0, 3, 16, 6), -- Alex Hales
(31, 1, 10, 5, 9, '4*', 3.00, 69.23, 0, 0, 2, 1, 0), -- Hunain Shah
(32, 1, 6, 2, 1, '1*', 0.00, 50.00, 0, 0, 0, 0, 0), -- Tymal Mills
(35, 1, 12, 11, 259, '60*', 64.75, 193.28, 0, 1, 1, 23, 17), -- Iftikhar Ahmed
(41, 1, 6, 3, 45, '30*', 45.00, 225.00, 0, 0, 1, 4, 3), -- Chris Jordan
(38, 1, 12, 12, 407, '82', 33.91, 122.22, 0, 4, 2, 33, 15), -- Mohammad Rizwan
(34, 1, 4, 4, 110, '53', 27.50, 157.14, 0, 1, 0, 10, 6), -- Johnson Charles
(37, 1, 5, 5, 123, '52', 24.60, 139.77, 0, 2, 2, 8, 4), -- Dawid Malan
(36, 1, 10, 9, 68, '28*', 17.00, 128.30, 0, 0, 0, 6, 0), -- Khushdil Shah
(39, 1, 11, 4, 38, '25', 12.66, 115.15, 0, 0, 1, 2, 2), -- David Willey
(44, 1, 12, 2, 18, '12', 9.00, 360.00, 0, 0, 0, 0, 3), -- Usama Mir
(40, 1, 9, 2, 12, '11', 6.00, 150.00, 0, 0, 0, 2, 0), -- Abbas Afridi
(42, 1, 4, 1, 0, '0', 0.00, 0.00, 0, 0, 1, 0, 0); -- Shahnawaz Dahani

INSERT INTO BattingRecords (player_id, league_id, total_matches_played, total_innings_played, total_tournament_runs, highest_score, average, strike_rate, hundreds, fifties, ducks, fours, sixes)
VALUES
(79, 2, 4, 4, 143, '70', 35.75, 140.19, 0, 1, 0, 10, 8),  -- Quinton de Kock
(78, 2, 9, 9, 274, '74', 34.25, 113.22, 0, 2, 0, 28, 4),  -- KL Rahul
(83, 2, 15, 15, 408, '89*', 31.38, 150, 0, 3, 2, 28, 27),  -- Marcus Stoinis
(80, 2, 15, 15, 358, '62', 29.83, 172.94, 0, 2, 2, 26, 26),  -- Nicholas Pooran
(70, 2, 16, 16, 605, '103*', 43.21, 181.13, 1, 5, 1, 65, 28),  -- Suryakumar Yadav 
(68, 2, 16, 15, 454, '75', 30.26, 142.76, 0, 3, 0, 54, 18),  -- Ishan Kishan
(67, 2, 16, 15, 231, '45*', 25.66, 158.21, 0, 0, 2, 12, 15),  -- Tim David
(69, 2, 16, 16, 332, '65', 20.75, 132.8, 0, 2, 2, 35, 17),  -- Rohit Sharma
(45, 2, 16, 15, 590, '92', 42.14, 147.5, 0, 4, 0, 46, 30),  -- Ruturaj Gaikwad
(47, 2, 14, 11, 326, '71*', 32.6, 172.48, 0, 2, 0, 24, 16),  -- Ajinkya Rahane
(46, 2, 16, 12, 104, '32*', 26, 182.45, 0, 0, 1, 3, 10),  -- MS Dhoni
(49, 2, 16, 12, 190, '25*', 23.75, 142.85, 0, 0, 0, 11, 9),  -- Ravindra Jadeja
(48, 2, 15, 10, 124, '23', 17.71, 136.26, 0, 0, 0, 12, 6),  -- Moeen Ali
(51, 2, 3, 2, 2, '1*', 0, 50, 0, 0, 0, 0, 0),  -- Mitchell Santner
(52, 2, 10, 1, 1, '1*', 0, 50, 0, 0, 0, 0, 0),  -- Deepak Chahar
(56, 2, 14, 14, 730, '84', 56.15, 153.68, 0, 8, 0, 60, 36),  -- Faf du Plessis
(58, 2, 14, 14, 639, '101*', 53.25, 139.82, 2, 6, 1, 65, 16),  -- Virat Kohli
(62, 2, 14, 14, 400, '77', 33.33, 183.48, 0, 5, 2, 29, 31),  -- Glenn Maxwell
(66, 2, 7, 2, 13, '13*', 13, 144.44, 0, 0, 1, 0, 1);  -- Vijaykumar Vyshak

INSERT INTO BattingRecords (player_id, league_id, total_matches_played, total_innings_played, total_tournament_runs, highest_score, average, strike_rate, hundreds, fifties, ducks, fours, sixes)
VALUES
(93, 3, 15, 15, 460, '90*', 41.81, 141.1, 0, 4, 0, 45, 17),  -- Aaron Hardie
(97, 3, 8, 2, 30, '17', 30, 115.38, 0, 0, 0, 1, 1),  -- Matthew Kelly
(91, 3, 9, 9, 214, '66*', 26.75, 131.28, 0, 2, 1, 24, 5),  -- Stephen Eskinazi
(99, 3, 16, 5, 35, '13*', 17.5, 134.61, 0, 0, 0, 2, 1),  -- Andrew Tye
(95, 3, 10, 5, 34, '24', 8.5, 89.47, 0, 0, 1, 1, 1),  -- Ashton Agar
(96, 3, 14, 2, 7, '5*', 7, 87.5, 0, 0, 0, 0, 0),  -- Jason Behrendorff
(89, 3, 4, 2, 45, '25*', 0, 204.54, 0, 0, 0, 4, 2),  -- Cooper Connolly
(106, 3, 5, 5, 164, '84', 41, 134.42, 0, 1, 0, 14, 5),  -- Nathan McSweeney
(25, 3, 8, 8, 278, '98', 34.75, 150.27, 0, 1, 0, 20, 15),  -- Colin Munro
(101, 3, 8, 8, 249, '94', 31.12, 137.56, 0, 2, 0, 32, 4),  -- Usman Khawaja
(102, 3, 8, 8, 192, '73', 24, 119.25, 0, 1, 0, 20, 2),  -- Marnus Labuschagne
(104, 3, 18, 17, 334, '57*', 23.85, 116.78, 0, 1, 0, 27, 4),  -- Jimmy Peirson
(100, 3, 8, 8, 187, '79', 23.37, 132.62, 0, 1, 0, 12, 8),  -- Sam Billings
(107, 3, 17, 13, 141, '48*', 14.1, 133.01, 0, 0, 2, 14, 4),  -- Michael Neser
(110, 3, 10, 2, 0, '0*', 0, 0, 0, 0, 1, 0, 0),  -- Spencer Johnson
(109, 3, 6, 2, 34, '28*', 0, 188.88, 0, 0, 0, 4, 1),  -- Xavier Bartlett
(114, 3, 5, 5, 346, '125*', 86.5, 174.74, 2, 1, 0, 18, 25),  -- Steven Smith
(15, 3, 10, 9, 263, '91*', 37.57, 128.92, 0, 1, 1, 24, 7),  -- James Vince
(118, 3, 16, 15, 306, '58', 27.81, 128.03, 0, 3, 2, 20, 9),  -- Moises Henriques
(121, 3, 6, 3, 23, '13*', 23, 143.75, 0, 0, 0, 3, 0),  -- Jackson Bird
(112, 3, 13, 13, 242, '43', 18.61, 111.52, 0, 0, 0, 21, 4),  -- Kurtis Patterson
(113, 3, 16, 15, 266, '55', 17.73, 117.69, 0, 2, 0, 20, 6),  -- Josh Philippe
(119, 3, 12, 7, 55, '30', 13.75, 152.77, 0, 0, 1, 4, 2),  -- Ben Dwarshuis
(116, 3, 15, 7, 51, '14', 8.5, 134.21, 0, 0, 1, 4, 1),  -- Sean Abbott
(120, 3, 9, 3, 4, '2*', 4, 80, 0, 0, 0, 0, 0),  -- Izharulhaq Naveed
(125, 3, 11, 11, 416, '87', 41.6, 141.01, 0, 3, 0, 40, 14),  -- Chris Lynn
(126, 3, 14, 14, 458, '100*', 35.23, 144.47, 1, 2, 2, 42, 18),  -- Matthew Short
(122, 3, 4, 4, 122, '65', 30.5, 135.55, 0, 2, 0, 13, 2),  -- Alex Carey
(124, 3, 14, 14, 312, '56*', 26, 127.86, 0, 1, 0, 24, 10),  -- Adam Hose
(123, 3, 4, 4, 34, '19', 8.5, 77.27, 0, 0, 0, 3, 1),  -- Travis Head
(131, 3, 6, 5, 28, '11', 5.6, 90.32, 0, 0, 1, 1, 1),  -- Ben Manenti
(129, 3, 6, 5, 23, '11', 4.6, 65.71, 0, 0, 0, 2, 0);  -- Cameron Boyce


-- Batting records for a specific player in a particular league. 
-- with player's name, total runs scored, highest score, average, and number of centuries.
SELECT
p.player_name,
br.total_tournament_runs AS total_runs,
br.highest_score,
br.average,
br.hundreds
FROM BattingRecords br
JOIN Players p ON br.player_id = p.player_id
WHERE br.league_id = 2  -- Replace {league_id} with the specific league ID
AND p.player_name = 'Virat Kohli';  -- Replace {player_name} with the specific player's name


-- Top 5 players with the highest strike rates in the tournament. 
-- with names, strike rates, and the total number of sixes they have hit.
SELECT
p.player_name,
br.strike_rate,
br.sixes
FROM BattingRecords br
JOIN Players p ON br.player_id = p.player_id
ORDER BY br.strike_rate DESC
LIMIT 5;


INSERT INTO BowlingRecords (player_id, league_id, total_matches_played, total_innings_played, overs, maidens, runs, wickets, average, economy, strike_rate)
VALUES
(21, 1, 10, 10, 38, 0, 314, 14, 22.42, 8.26, 16.2),  -- Hasan Ali
(18, 1, 4, 4, 16, 0, 154, 4, 38.5, 9.62, 24),  -- Daniel Sams
(22, 1, 4, 4, 15, 0, 157, 3, 52.33, 10.46, 30),  -- Tabraiz Shamsi
(19, 1, 10, 9, 23, 0, 147, 2, 73.5, 6.39, 69),  -- Shoaib Malik
(20, 1, 3, 3, 7, 0, 78, 1, 78, 11.14, 42),  -- Anwar Ali
(16, 1, 8, 7, 20, 0, 176, 2, 88, 8.8, 60),  -- Mohammad Nawaz
(17, 1, 9, 1, 1, 0, 11, 0, 0, 11, NULL),  -- Kieron Pollard
(12, 1, 9, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Irfan Khan
(13, 1, 7, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Tim Seifert
(14, 1, 10, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Shan Masood
(15, 1, 9, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- James Vince
(10, 1, 9, 9, 36, 1, 310, 14, 22.14, 8.61, 15.4),  -- Shaheen Shah Afridi
(11, 1, 9, 9, 32, 0, 316, 11, 28.72, 9.87, 17.4),  -- Zaman Khan
(7, 1, 8, 7, 18, 0, 151, 3, 50.33, 8.38, 36),  -- Sikandar Raza
(9, 1, 4, 4, 14, 0, 132, 2, 66, 9.42, 42),  -- Haris Rauf
(8, 1, 4, 4, 10, 0, 79, 1, 79, 7.9, 60),  -- David Wiese
(5, 1, 4, 4, 12, 0, 106, 1, 106, 8.83, 72),  -- George Linde
(1, 1, 5, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Abdullah Shafique
(2, 1, 8, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Fakhar Zaman
(3, 1, 5, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Shai Hope
(4, 1, 7, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Rassie van der Dussen
(29, 1, 12, 12, 38, 0, 251, 12, 20.91, 6.6, 19),  -- Imad Wasim
(33, 1, 11, 11, 44, 2, 333, 15, 22.2, 7.56, 17.6),  -- Naseem Shah
(30, 1, 12, 12, 44, 0, 376, 14, 26.85, 8.54, 18.8),  -- Shadab Khan
(31, 1, 10, 9, 23.4, 1, 225, 8, 28.12, 9.5, 17.7),  -- Hunain Shah
(32, 1, 6, 6, 21.5, 0, 216, 6, 36, 9.89, 21.8),  -- Tymal Mills
(28, 1, 12, 10, 28, 0, 276, 6, 46, 9.85, 28),  -- Faheem Ashraf
(26, 1, 12, 5, 12, 0, 97, 2, 48.5, 8.08, 36),  -- Agha Salman
(23, 1, 12, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Azam Khan
(24, 1, 10, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Alex Hales
(25, 1, 10, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Colin Munro
(44, 1, 12, 12, 46.5, 0, 381, 24, 15.87, 8.13, 11.7),  -- Usama Mir
(40, 1, 9, 9, 29, 0, 248, 13, 19.07, 8.55, 13.3),  -- Abbas Afridi
(39, 1, 11, 11, 41, 0, 306, 15, 20.4, 7.46, 16.4),  -- David Willey
(36, 1, 10, 6, 14.2, 1, 102, 4, 25.5, 7.11, 21.5),  -- Khushdil Shah
(41, 1, 6, 6, 21, 0, 177, 6, 29.5, 8.42, 21),  -- Chris Jordan
(35, 1, 12, 7, 13, 0, 121, 2, 60.5, 9.3, 39),  -- Iftikhar Ahmed
(42, 1, 4, 4, 9, 0, 97, 1, 97, 10.77, 54),  -- Shahnawaz Dahani
(34, 1, 4, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Johnson Charles
(37, 1, 5, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Dawid Malan
(38, 1, 12, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Mohammad Rizwan
(83, 2, 15, 5, 10.5, 0, 100, 5, 20, 9.23, 13),  -- Marcus Stoinis
(82, 2, 13, 6, 7, 0, 59, 0, 0, 8.42, NULL),  -- Kyle Mayers
(79, 2, 4, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Quinton de Kock
(80, 2, 15, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Nicholas Pooran
(78, 2, 9, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- KL Rahul
(60, 2, 16, 16, 38, 0, 361, 6, 60.16, 9.5, 38),  -- Cameron Green
(67, 2, 16, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Tim David
(68, 2, 16, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Ishan Kishan
(69, 2, 16, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Rohit Sharma
(70, 2, 16, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Suryakumar Yadav
(49, 2, 16, 16, 57, 0, 431, 20, 21.55, 7.56, 17.1),  -- Ravindra Jadeja
(48, 2, 15, 11, 26, 0, 195, 9, 21.66, 7.5, 17.3),  -- Moeen Ali
(52, 2, 10, 10, 34, 0, 297, 13, 22.84, 8.73, 15.6),  -- Deepak Chahar
(51, 2, 3, 3, 12, 0, 81, 3, 27, 6.75, 24),  -- Mitchell Santner
(46, 2, 16, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- MS Dhoni
(45, 2, 16, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Ruturaj Gaikwad
(47, 2, 14, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Ajinkya Rahane
(66, 2, 7, 7, 24, 0, 253, 9, 28.11, 10.54, 16),  -- Vijaykumar Vyshak
(62, 2, 14, 7, 10.2, 0, 94, 3, 31.33, 9.09, 20.6),  -- Glenn Maxwell
(35, 2, 10, 5, 7, 0, 95, 1, 95, 13.57, 42),  -- Iftikhar Ahmed
(56, 2, 14, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Faf du Plessis
(58, 2, 14, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Virat Kohli
(96, 3, 14, 14, 55, 0, 368, 21, 17.52, 6.69, 15.7),  -- Jason Behrendorff
(97, 3, 8, 8, 27.1, 0, 209, 11, 19, 7.69, 14.8),  -- Matthew Kelly
(99, 3, 16, 16, 62, 1, 524, 26, 20.15, 8.45, 14.3),  -- Andrew Tye
(93, 3, 15, 5, 14, 0, 112, 5, 22.4, 8, 16.8),  -- Aaron Hardie
(95, 3, 10, 10, 37, 0, 271, 6, 45.16, 7.32, 37),  -- Ashton Agar
(81, 3, 16, 7, 12.2, 0, 94, 2, 47, 7.62, 37),  -- Ashton Turner
(89, 3, 4, 2, 2, 0, 15, 0, 0, 7.5, NULL),  -- Cooper Connolly
(56, 3, 7, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Faf du Plessis
(91, 3, 9, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Stephen Eskinazi
(107, 3, 17, 16, 58.1, 0, 495, 26, 19.03, 8.51, 13.4),  -- Michael Neser
(106, 3, 5, 2, 5, 0, 30, 1, 30, 6, 30),  -- Nathan McSweeney
(110, 3, 10, 10, 37.2, 1, 282, 9, 31.33, 7.55, 24.8),  -- Spencer Johnson
(109, 3, 6, 6, 18, 0, 163, 5, 32.6, 9.05, 21.6),  -- Xavier Bartlett
(102, 3, 8, 1, 1, 0, 20, 0, 0, 20, NULL),  -- Marnus Labuschagne
(100, 3, 8, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Sam Billings
(101, 3, 8, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Usman Khawaja
(25, 3, 8, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Colin Munro
(104, 3, 18, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Jimmy Peirson
(116, 3, 15, 15, 54.4, 2, 407, 29, 14.03, 7.44, 11.3),  -- Sean Abbott
(121, 3, 6, 6, 22, 0, 158, 8, 19.75, 7.18, 16.5),  -- Jackson Bird
(119, 3, 12, 12, 43.5, 1, 347, 15, 23.13, 7.91, 17.5),  -- Ben Dwarshuis
(120, 3, 9, 9, 35, 0, 258, 9, 28.66, 7.37, 23.3),  -- Izharulhaq Naveed
(118, 3, 16, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Moises Henriques
(112, 3, 13, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Kurtis Patterson
(113, 3, 16, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Josh Philippe
(114, 3, 5, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Steven Smith
(15, 3, 10, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- James Vince
(95, 3, 13, 13, 39, 0, 365, 18, 20.27, 9.35, 13),  -- Ashton Agar
(126, 3, 14, 14, 35.1, 0, 251, 11, 22.81, 7.13, 19.1),  -- Matthew Short
(6, 3, 8, 7, 28, 0, 180, 6, 30, 6.42, 28),  -- Rashid Khan
(129, 3, 6, 6, 22, 0, 153, 5, 30.6, 6.95, 26.4),  -- Cameron Boyce
(131, 3, 6, 6, 15.3, 0, 143, 3, 47.66, 9.22, 31),  -- Ben Manenti
(122, 3, 4, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Alex Carey
(123, 3, 4, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Travis Head
(124, 3, 14, 0, 0, 0, 0, 0, 0, NULL, NULL),  -- Adam Hose
(125, 3, 11, 0, 0, 0, 0, 0, 0, NULL, NULL);  -- Chris Lynn

-- Bowling records for a specific player in a particular league. 
-- with player's name, total wickets taken, best bowling figures (wickets/runs), average, and economy rate.
SELECT
p.player_name,
br.wickets,
CONCAT(br.wickets, '/', br.runs) AS best_bowling_figures,
br.average,
br.economy
FROM BowlingRecords br
JOIN Players p ON br.player_id = p.player_id
WHERE br.league_id = 1  -- Replace 1 with the specific league ID
AND p.player_name = 'Shaheen Shah Afridi';  -- Replace 'Shaheen Shah Afridi' with the specific player's name

-- Top 5 bowlers with the best bowling averages in the tournament.
SELECT
p.player_name,
br.average,
br.economy,
br.maidens
FROM BowlingRecords br
JOIN Players p ON br.player_id = p.player_id
ORDER BY br.average DESC
LIMIT 5;

-- Using pecific types of join 
-- Players along with their respective coaches.
SELECT 
Players.player_id,
Players.player_name,
Players.position,
Teams.team_name,
Teams.head_coach,
Teams.batting_coach,
Teams.bowling_coach,
Teams.fielding_coach
FROM 
Players
INNER JOIN Teams ON Players.team_id = Teams.team_id;

-- Leagues along with users who have accounts associated with those leagues.
SELECT 
Leagues.league_id,
Leagues.league_name,
Leagues.status,
Users.username,
Users.email,
Users.join_date,
Users.last_login
FROM 
Leagues
RIGHT JOIN Teams ON Leagues.league_id = Teams.league_id
RIGHT JOIN Users ON Teams.team_id = Users.user_id;


-- Stored function 
-- Stored function that calculates the total runs scored by a player in a specific league from the BattingRecords table.
-- Used to perform specific calculations or data manipulations that can't be easily achieved directly in SQL queries.
-- Enhancing code reusability and maintaining consistency in database operations.

-- Ensuring to use the correct database
USE CCXI;

-- Drop the function if it already exists.
DROP FUNCTION IF EXISTS GetTotalRuns;

-- Create the stored function
DELIMITER //

CREATE FUNCTION GetTotalRuns(p_player_id INT, p_league_id INT) RETURNS INT
DETERMINISTIC
READS SQL DATA
BEGIN
DECLARE v_total_runs INT;
    
SELECT COALESCE(SUM(total_tournament_runs), 0) -- Used COALESCE to ensure that if there are no rows matching the criteria, the function returns 0 instead of NULL.
INTO v_total_runs
FROM BattingRecords
WHERE player_id = p_player_id AND league_id = p_league_id;
    
RETURN v_total_runs;
END //

DELIMITER ;


-- Usage of the GetTotalRuns function
SELECT 
player_id,
player_name,
GetTotalRuns(player_id, 1) AS total_runs_in_league_1
FROM 
Players
WHERE 
team_id = 1;


-- Stored Procedure
-- Stored procedures provide reusable and efficient ways to encapsulate and execute database logic, enhancing performance, security, and maintainability in applications.

-- The stored procedure will update the last_login timestamp of a user in the Users table when they log in.
-- First, ensure you are using the correct database
USE CCXI;

-- Drop the procedure if it already exists.
DROP PROCEDURE IF EXISTS UpdateLastLogin;

-- Create the stored procedure
DELIMITER //

CREATE PROCEDURE UpdateLastLogin (IN p_user_id INT)
BEGIN
UPDATE Users
SET last_login = CURRENT_TIMESTAMP()
WHERE user_id = p_user_id;
END //

DELIMITER ;


-- Before calling the stored procedure
SELECT user_id, username, last_login
FROM Users
WHERE user_id = 1;

-- Call the stored procedure to update last login for user_id = 1
CALL UpdateLastLogin(1);

-- After calling the stored procedure
SELECT user_id, username, last_login
FROM Users
WHERE user_id = 1;



-- Trigger
-- The purpose of this trigger is to enforce the rule that each team can have only one captain at a time. 
DELIMITER //

CREATE TRIGGER trg_EnsureOneCaptainPerTeam
BEFORE INSERT ON Players
FOR EACH ROW
BEGIN
DECLARE captain_count INT;
    
IF NEW.is_captain = true THEN
SET captain_count = (SELECT COUNT(*) FROM Players WHERE team_id = NEW.team_id AND is_captain = true);
        
IF captain_count > 0 THEN
SIGNAL SQLSTATE '45000'
SET MESSAGE_TEXT = 'Each team can have only one captain at a time.';
END IF;
END IF;
END //

DELIMITER ;


DROP TRIGGER IF EXISTS trg_EnsureOneCaptainPerTeam;

-- Before adding the captain.
SELECT * FROM Players WHERE is_captain = true;

-- Attempt to add a captain to a team
INSERT INTO Players (player_id, player_name, team_id, position, batting_style, bowling_style, nationality, is_captain)
VALUES (1, 'Captain Name', 1, 'Batsman', 'Right-handed', 'None', 'Nationality', true);
-- This should thorw an error as there are already captain for each team present. 


-- View
-- The UserTeamPlayerInfo view combines information from the Users, Teams, Players, and Matches tables. 
CREATE VIEW UserTeamPlayerInfo AS
SELECT u.user_id, u.username, u.email,
t.team_id, t.team_name, t.home_ground,
p.player_id, p.player_name, p.position,
m.match_id, m.match_date, m.venue
FROM Users u
JOIN User_FavouriteTeams uf ON u.user_id = uf.user_id
JOIN Teams t ON uf.team_id = t.team_id
LEFT JOIN Players p ON t.team_id = p.team_id
LEFT JOIN Matches m ON t.team_id = m.team1_id OR t.team_id = m.team2_id;

-- It helps in understanding which teams users are interested in, 
-- who the players are on those teams, and when and where the matches involving those teams will be held. 

-- Query using the view to produce a logically arranged result set.
SELECT user_id, username, email,
team_id, team_name, home_ground,
player_id, player_name, position,
match_id, match_date, venue
FROM UserTeamPlayerInfo
WHERE user_id = 3;  -- Replace with your desired user_id for analysis
